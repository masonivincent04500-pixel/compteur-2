<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Modifier ma cagnotte</title>
</head>
<body>

<h2 id="titre"></h2>

<input type="number" id="montant" placeholder="Ajouter un montant">
<button onclick="ajouter()">Ajouter</button>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBnTkiUSRgVlD0sLTuV0YV92LWkPWBQAbA",
  authDomain: "compteur-million-2.firebaseapp.com",
  databaseURL: "https://compteur-million-2-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "compteur-million-2",
  storageBucket: "compteur-million-2.firebasestorage.app",
  messagingSenderId: "226299332536",
  appId: "1:226299332536:web:4d79be3a4ed0b2ba50714d"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const params = new URLSearchParams(window.location.search);
const campingId = params.get('id');

if (!campingId) {
  document.body.innerHTML = "ID camping manquant !";
} else {
  document.getElementById("titre").innerText = "Modifier la cagnotte - " + campingId;
}

const campingRef = database.ref('campings/' + campingId);

function ajouter() {
  const montant = parseInt(document.getElementById('montant').value);
  if (!isNaN(montant)) {
    campingRef.transaction(current => {
      return (current || 0) + montant;
    }, (err, committed, snapshot) => {
      if (err) console.error("Erreur Firebase :", err);
      else if (committed) console.log("Valeur mise Ã  jour :", snapshot.val());
    });
  }
}
</script>

</body>
</html>
