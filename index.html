<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Cagnotte Totale</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');
body {
  margin:0;
  background: linear-gradient(135deg, #1e3c72, #2a5298);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  font-family:'Orbitron', monospace;
  color:#00ff00;
}
#total {
  font-size:220px;
  text-shadow:0 0 10px #00ff00,0 0 20px #00ff00,0 0 40px #00ff00;
  text-align:center;
}
</style>
</head>
<body>

<div id="total">0</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
// Configuration Firebase
const firebaseConfig = {
  apiKey: "AIzaSyBnTkiUSRgVlD0sLTuV0YV92LWkPWBQAbA",
  authDomain: "compteur-million-2.firebaseapp.com",
  databaseURL: "https://compteur-million-2-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "compteur-million-2",
  storageBucket: "compteur-million-2.firebasestorage.app",
  messagingSenderId: "226299332536",
  appId: "1:226299332536:web:4d79be3a4ed0b2ba50714d"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const campingsRef = database.ref('campings');
const totalDiv = document.getElementById('total');

// Mettre à jour le total global en temps réel
const campingsRef = database.ref('campings');
const totalDiv = document.getElementById('total');

campingsRef.on('value', snapshot => {
  const data = snapshot.val() || {};
  let total = 0;
  for(let key in data){
    total += Number(data[key]);  // <- conversion obligatoire
  }
  totalDiv.innerText = total;
});

// Reset secret (clic 5 fois en haut à gauche)
let clickCount = 0;
const secretZone = {x:0, y:0, width:100, height:100};

document.body.addEventListener('click', function(e){
  if(e.clientX <= secretZone.width && e.clientY <= secretZone.height){
    clickCount++;
    if(clickCount >=5){
      campingsRef.once('value', snapshot=>{
        snapshot.forEach(child=>{
          database.ref('campings/' + child.key).set(0);
        });
      });
      clickCount = 0;
      alert("Cagnotte remise à 0 !");
    }
  } else {
    clickCount = 0;
  }
});
</script>

</body>
</html>
